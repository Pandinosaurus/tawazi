
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../dag/">
      
      
        <link rel="next" href="../future_developments/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.10">
    
    
      
        <title>DAGExecution - tawazi</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tawazi.dag.DAGExecution" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="tawazi" class="md-header__button md-logo" aria-label="tawazi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            tawazi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DAGExecution
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mindee/tawazi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mindee/tawazi
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="tawazi" class="md-nav__button md-logo" aria-label="tawazi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    tawazi
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mindee/tawazi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mindee/tawazi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../home/" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../decorators/" class="md-nav__link">
        decorators
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../nodes/" class="md-nav__link">
        ExecNodes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../dag/" class="md-nav__link">
        DAG
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          DAGExecution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        DAGExecution
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution" class="md-nav__link">
    tawazi.dag.DAGExecution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.get_node_by_id" class="md-nav__link">
    get_node_by_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.get_nodes_by_tag" class="md-nav__link">
    get_nodes_by_tag()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../future_developments/" class="md-nav__link">
        Future Developments
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/mindee/tawazi/releases" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution" class="md-nav__link">
    tawazi.dag.DAGExecution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.get_node_by_id" class="md-nav__link">
    get_node_by_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tawazi.dag.DAGExecution.get_nodes_by_tag" class="md-nav__link">
    get_nodes_by_tag()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



  <h1>DAGExecution</h1>

<div class="doc doc-object doc-class">


<a id="tawazi.dag.DAGExecution"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="typing.Generic">Generic</span>[<span title="tawazi.consts.P">P</span>, <span title="tawazi.consts.RVDAG">RVDAG</span>]</code></p>

  
      <p>A disposable callable instance of a DAG.</p>
<p>It holds information about the last execution. Hence it is not threadsafe.
It might be reusable, however it is not recommended to reuse an instance of DAGExecutor!.</p>


        <details class="quote">
          <summary>Source code in <code>tawazi/dag.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="k">class</span> <span class="nc">DAGExecution</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">RVDAG</span><span class="p">]):</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A disposable callable instance of a DAG.</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">    It holds information about the last execution. Hence it is not threadsafe.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">    It might be reusable, however it is not recommended to reuse an instance of DAGExecutor!.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="n">dag</span><span class="p">:</span> <span class="n">DAG</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">RVDAG</span><span class="p">],</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="n">target_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="n">exclude_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="n">cache_deps_of</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="n">cache_in</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="n">from_cache</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>        <span class="n">call_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="p">):</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">            dag (DAG): The attached DAG.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">            target_nodes (Optional[List[Alias]]): The leave ExecNodes to execute.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">                If None will execute all ExecNodes.</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">                Defaults to None.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">            exclude_nodes (Optional[List[Alias]]): The leave ExecNodes to exclude.</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">                If None will exclude all ExecNodes.</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">                Defaults to None.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">            cache_deps_of (Optional[List[Alias]]): cache all the dependencies of these nodes.</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">                This option can not be used together with target_nodes nor exclude_nodes.</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">            cache_in (str):</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">                the path to the file where the execution should be cached.</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">                The path should end in `.pkl`.</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">                Will skip caching if `cache_in` is Falsy.</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">                Will raise PickleError if any of the values passed around in the DAG is not pickleable.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">                Defaults to &quot;&quot;.</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">            from_cache (str):</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">                the path to the file where the execution should be loaded from.</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">                The path should end in `.pkl`.</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">                Will skip loading from cache if `from_cache` is Falsy.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">                Defaults to &quot;&quot;.</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">            call_id (Optional[str]): identification of the current execution.</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">                This will be inserted into thread_name_prefix while executing the threadPool.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">                It will be used in the future for identifying the execution inside Processes etc.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="c1"># todo: Maybe we can support .dill to extend the possibilities of the exchanged values, but this won&#39;t solve the whole problem</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span> <span class="o">=</span> <span class="n">target_nodes</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span> <span class="o">=</span> <span class="n">exclude_nodes</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span> <span class="o">=</span> <span class="n">cache_deps_of</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span> <span class="o">=</span> <span class="n">cache_in</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">from_cache</span> <span class="o">=</span> <span class="n">from_cache</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="c1"># NOTE: from_cache is orthogonal to cache_in which means that if cache_in is set at the same time as from_cache.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="c1">#  in this case the DAG will be loaded from_cache and the results will be saved again to the cache_in file.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="o">=</span> <span class="n">call_id</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>        <span class="c1"># get the leaves ids to execute in case of a subgraph</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span> <span class="o">=</span> <span class="n">target_nodes</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span> <span class="o">=</span> <span class="n">exclude_nodes</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">ExecNode</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="c1"># logic parts</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">_make_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">_make_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scheduled_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">executed</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="k">def</span> <span class="nf">cache_in</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The path to the file where the execution should be cached.</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">            str: The path to the file where the execution should be cached.</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_in</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="nd">@cache_in</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="k">def</span> <span class="nf">cache_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>        <span class="k">if</span> <span class="n">cache_in</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cache_in</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pkl&quot;</span><span class="p">):</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cache_in should end with.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_in</span> <span class="o">=</span> <span class="n">cache_in</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="k">def</span> <span class="nf">from_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the file path from which the cached execution should be loaded.</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            str: the file path of the cached execution</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_cache</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="nd">@from_cache</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="k">def</span> <span class="nf">from_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_cache</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>        <span class="k">if</span> <span class="n">from_cache</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">from_cache</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pkl&quot;</span><span class="p">):</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;from_cache should end with.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_from_cache</span> <span class="o">=</span> <span class="n">from_cache</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>    <span class="k">def</span> <span class="nf">cache_deps_of</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]:</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cache all the dependencies of these nodes.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            Optional[List[Alias]]: List of Aliases passed to cache_deps_of while instantiating DAGExecution</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_deps_of</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>    <span class="nd">@cache_deps_of</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>    <span class="k">def</span> <span class="nf">cache_deps_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_deps_of</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="p">)</span> <span class="ow">and</span> <span class="n">cache_deps_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                <span class="s2">&quot;cache_deps_of can not be used together with target_nodes or exclude_nodes&quot;</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>            <span class="p">)</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_deps_of</span> <span class="o">=</span> <span class="n">cache_deps_of</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>    <span class="c1"># we need to reimplement the public methods of DAG here in order to have a constant public interface</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>    <span class="c1"># getters</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>    <span class="k">def</span> <span class="nf">get_nodes_by_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ExecNode</span><span class="p">]:</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all the nodes with the given tag.</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            tag (Any): tag of ExecNodes in question</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">            List[ExecNode]: corresponding ExecNodes</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executed</span><span class="p">:</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">ex_n</span> <span class="k">for</span> <span class="n">ex_n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">ex_n</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">tag</span><span class="p">]</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">get_nodes_by_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="k">def</span> <span class="nf">get_node_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExecNode</span><span class="p">:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get node with the given id.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">            id_ (Identifier): id of the ExecNode</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">            ExecNode: Corresponding ExecNode</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="c1"># TODO: ? catch the keyError and</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="c1">#   help the user know the id of the ExecNode by pointing to documentation!?</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executed</span><span class="p">:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">get_node_by_id</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="n">target_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>        <span class="n">exclude_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Does the same thing as DAG.setup.</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">            target_nodes (Optional[List[XNId]], optional): The ExecNodes that the user aims to use in the DAG.</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">                This might include setup or non setup ExecNodes. If None is provided, will run all setup ExecNodes. Defaults to None.</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">            exclude_nodes (Optional[List[XNId]], optional): The ExecNodes that the user aims to exclude from the DAG.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">                The user is responsible for ensuring that the overlapping between the target_nodes and exclude_nodes is logical.</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">target_nodes</span><span class="o">=</span><span class="n">target_nodes</span><span class="p">,</span> <span class="n">exclude_nodes</span><span class="o">=</span><span class="n">exclude_nodes</span><span class="p">)</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RVDAG</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Call the DAG.</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">            *args: positional arguments to pass in to the DAG</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            **kwargs: keyword arguments to pass in to the DAG</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">            TawaziUsageError: if the DAGExecution has already been executed.</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">            RVDAG: the return value of the DAG&#39;s Execution</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executed</span><span class="p">:</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>            <span class="k">raise</span> <span class="n">TawaziUsageError</span><span class="p">(</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>                <span class="s2">&quot;DAGExecution object should not be reused. Instantiate a new one&quot;</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>            <span class="p">)</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="c1"># NOTE: *args will be ignored if self.from_cache is set!</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="n">dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="c1"># maybe call_id will be changed to Union[int, str].</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="c1"># Keep call_id as Optional[str] for now</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">call_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="c1"># 1. copy the ExecNodes</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">call_xn_dict</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">_make_call_xn_dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_cache</span><span class="p">:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_cache</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>                <span class="n">cached_results</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>            <span class="c1"># set the result for the ExecNode that were previously executed</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>            <span class="c1"># this will make them skip execution inside the scheduler</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>            <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">cached_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>                <span class="n">call_xn_dict</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="c1"># 2. Execute the scheduler</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">call_xn_dict</span><span class="p">,</span> <span class="n">call_id</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="n">xn</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">xn</span><span class="o">.</span><span class="n">result</span> <span class="k">for</span> <span class="n">xn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()}</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="c1"># 3. cache in the graph results</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>            <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>                <span class="c1"># NOTE: we are currently only storing the results of the execution,</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>                <span class="c1">#  this means that the configuration of the ExecNodes are lost!</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>                <span class="c1">#  But this is ok since it should not change between executions!</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>                <span class="c1">#  for example, a setup ExecNode should stay a setup ExecNode between caching in the results and reading back the cached results</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>                <span class="c1">#  the same goes for the DAG itself, the behavior when an error is encountered &amp; its concurrency will be controlled via the constructor</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>                    <span class="n">non_cacheable_ids</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Identifier</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>                    <span class="k">for</span> <span class="n">aliases</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span><span class="p">:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>                        <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">_alias_to_ids</span><span class="p">(</span><span class="n">aliases</span><span class="p">)</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>                        <span class="n">non_cacheable_ids</span> <span class="o">=</span> <span class="n">non_cacheable_ids</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>                    <span class="n">to_cache_results</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>                        <span class="n">id_</span><span class="p">:</span> <span class="n">res</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>                        <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>                        <span class="k">if</span> <span class="n">id_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">non_cacheable_ids</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>                    <span class="p">}</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>                    <span class="n">to_cache_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>                    <span class="n">to_cache_results</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">,</span> <span class="n">fix_imports</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>                <span class="p">)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>        <span class="c1"># TODO: make DAGExecution reusable but do not guarantee ThreadSafety!</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">executed</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>        <span class="c1"># 3. extract the returned value/values</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>        <span class="k">return</span> <span class="n">dag</span><span class="o">.</span><span class="n">_get_return_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="p">)</span>  <span class="c1"># type: ignore[return-value]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="tawazi.dag.DAGExecution.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dag</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude_nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_deps_of</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache_in</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">from_cache</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">call_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#tawazi.dag.DAGExecution.__init__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dag</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="tawazi.dag.DAG" href="../dag/#tawazi.dag.DAG">DAG</a></code>
          </td>
          <td><p>The attached DAG.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="tawazi.node.Alias">Alias</span>]]</code>
          </td>
          <td><p>The leave ExecNodes to execute.
If None will execute all ExecNodes.
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>exclude_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="tawazi.node.Alias">Alias</span>]]</code>
          </td>
          <td><p>The leave ExecNodes to exclude.
If None will exclude all ExecNodes.
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cache_deps_of</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="tawazi.node.Alias">Alias</span>]]</code>
          </td>
          <td><p>cache all the dependencies of these nodes.
This option can not be used together with target_nodes nor exclude_nodes.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cache_in</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>the path to the file where the execution should be cached.
The path should end in <code>.pkl</code>.
Will skip caching if <code>cache_in</code> is Falsy.
Will raise PickleError if any of the values passed around in the DAG is not pickleable.
Defaults to "".</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>from_cache</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>the path to the file where the execution should be loaded from.
The path should end in <code>.pkl</code>.
Will skip loading from cache if <code>from_cache</code> is Falsy.
Defaults to "".</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>call_id</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>identification of the current execution.
This will be inserted into thread_name_prefix while executing the threadPool.
It will be used in the future for identifying the execution inside Processes etc.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>tawazi/dag.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="n">dag</span><span class="p">:</span> <span class="n">DAG</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">RVDAG</span><span class="p">],</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>    <span class="n">target_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>    <span class="n">exclude_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="n">cache_deps_of</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="n">cache_in</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>    <span class="n">from_cache</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>    <span class="n">call_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="p">):</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        dag (DAG): The attached DAG.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        target_nodes (Optional[List[Alias]]): The leave ExecNodes to execute.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">            If None will execute all ExecNodes.</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">        exclude_nodes (Optional[List[Alias]]): The leave ExecNodes to exclude.</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">            If None will exclude all ExecNodes.</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">        cache_deps_of (Optional[List[Alias]]): cache all the dependencies of these nodes.</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">            This option can not be used together with target_nodes nor exclude_nodes.</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">        cache_in (str):</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">            the path to the file where the execution should be cached.</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">            The path should end in `.pkl`.</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">            Will skip caching if `cache_in` is Falsy.</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">            Will raise PickleError if any of the values passed around in the DAG is not pickleable.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">            Defaults to &quot;&quot;.</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">        from_cache (str):</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">            the path to the file where the execution should be loaded from.</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">            The path should end in `.pkl`.</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">            Will skip loading from cache if `from_cache` is Falsy.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">            Defaults to &quot;&quot;.</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">        call_id (Optional[str]): identification of the current execution.</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">            This will be inserted into thread_name_prefix while executing the threadPool.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">            It will be used in the future for identifying the execution inside Processes etc.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="c1"># todo: Maybe we can support .dill to extend the possibilities of the exchanged values, but this won&#39;t solve the whole problem</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span> <span class="o">=</span> <span class="n">target_nodes</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span> <span class="o">=</span> <span class="n">exclude_nodes</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span> <span class="o">=</span> <span class="n">cache_deps_of</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span> <span class="o">=</span> <span class="n">cache_in</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">from_cache</span> <span class="o">=</span> <span class="n">from_cache</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="c1"># NOTE: from_cache is orthogonal to cache_in which means that if cache_in is set at the same time as from_cache.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="c1">#  in this case the DAG will be loaded from_cache and the results will be saved again to the cache_in file.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="o">=</span> <span class="n">call_id</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="c1"># get the leaves ids to execute in case of a subgraph</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span> <span class="o">=</span> <span class="n">target_nodes</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span> <span class="o">=</span> <span class="n">exclude_nodes</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">ExecNode</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Identifier</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="c1"># logic parts</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">_make_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">_make_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude_nodes</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">scheduled_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">executed</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="tawazi.dag.DAGExecution.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#tawazi.dag.DAGExecution.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Call the DAG.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code><span title="tawazi.consts.P">P</span>.<span title="tawazi.consts.P.args">args</span></code>
          </td>
          <td><p>positional arguments to pass in to the DAG</p></td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="tawazi.consts.P">P</span>.<span title="tawazi.consts.P.kwargs">kwargs</span></code>
          </td>
          <td><p>keyword arguments to pass in to the DAG</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tawazi.errors.TawaziUsageError">TawaziUsageError</span></code>
          </td>
          <td><p>if the DAGExecution has already been executed.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>RVDAG</code></td>          <td>
                <code><span title="tawazi.consts.RVDAG">RVDAG</span></code>
          </td>
          <td><p>the return value of the DAG's Execution</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>tawazi/dag.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RVDAG</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Call the DAG.</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        *args: positional arguments to pass in to the DAG</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">        **kwargs: keyword arguments to pass in to the DAG</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">        TawaziUsageError: if the DAGExecution has already been executed.</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        RVDAG: the return value of the DAG&#39;s Execution</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executed</span><span class="p">:</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="k">raise</span> <span class="n">TawaziUsageError</span><span class="p">(</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>            <span class="s2">&quot;DAGExecution object should not be reused. Instantiate a new one&quot;</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="p">)</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>    <span class="c1"># NOTE: *args will be ignored if self.from_cache is set!</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="n">dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>    <span class="c1"># maybe call_id will be changed to Union[int, str].</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="c1"># Keep call_id as Optional[str] for now</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>    <span class="n">call_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="c1"># 1. copy the ExecNodes</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="n">call_xn_dict</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">_make_call_xn_dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_cache</span><span class="p">:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_cache</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>            <span class="n">cached_results</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="c1"># set the result for the ExecNode that were previously executed</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="c1"># this will make them skip execution inside the scheduler</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">cached_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="n">call_xn_dict</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="c1"># 2. Execute the scheduler</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">call_xn_dict</span><span class="p">,</span> <span class="n">call_id</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="n">xn</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">xn</span><span class="o">.</span><span class="n">result</span> <span class="k">for</span> <span class="n">xn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()}</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>    <span class="c1"># 3. cache in the graph results</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>        <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_in</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>            <span class="c1"># NOTE: we are currently only storing the results of the execution,</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>            <span class="c1">#  this means that the configuration of the ExecNodes are lost!</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>            <span class="c1">#  But this is ok since it should not change between executions!</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>            <span class="c1">#  for example, a setup ExecNode should stay a setup ExecNode between caching in the results and reading back the cached results</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>            <span class="c1">#  the same goes for the DAG itself, the behavior when an error is encountered &amp; its concurrency will be controlled via the constructor</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>                <span class="n">non_cacheable_ids</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Identifier</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>                <span class="k">for</span> <span class="n">aliases</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_deps_of</span><span class="p">:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>                    <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">_alias_to_ids</span><span class="p">(</span><span class="n">aliases</span><span class="p">)</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>                    <span class="n">non_cacheable_ids</span> <span class="o">=</span> <span class="n">non_cacheable_ids</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>                <span class="n">to_cache_results</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>                    <span class="n">id_</span><span class="p">:</span> <span class="n">res</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>                    <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>                    <span class="k">if</span> <span class="n">id_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">non_cacheable_ids</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>                <span class="p">}</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>                <span class="n">to_cache_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>                <span class="n">to_cache_results</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">,</span> <span class="n">fix_imports</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>            <span class="p">)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="c1"># TODO: make DAGExecution reusable but do not guarantee ThreadSafety!</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">executed</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="c1"># 3. extract the returned value/values</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="k">return</span> <span class="n">dag</span><span class="o">.</span><span class="n">_get_return_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="p">)</span>  <span class="c1"># type: ignore[return-value]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="tawazi.dag.DAGExecution.setup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setup</span><span class="p">(</span><span class="n">target_nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude_nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#tawazi.dag.DAGExecution.setup" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Does the same thing as DAG.setup.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[XNId]]</code>
          </td>
          <td><p>The ExecNodes that the user aims to use in the DAG.
This might include setup or non setup ExecNodes. If None is provided, will run all setup ExecNodes. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>exclude_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[XNId]]</code>
          </td>
          <td><p>The ExecNodes that the user aims to exclude from the DAG.
The user is responsible for ensuring that the overlapping between the target_nodes and exclude_nodes is logical.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>tawazi/dag.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>    <span class="n">target_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>    <span class="n">exclude_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Alias</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Does the same thing as DAG.setup.</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        target_nodes (Optional[List[XNId]], optional): The ExecNodes that the user aims to use in the DAG.</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">            This might include setup or non setup ExecNodes. If None is provided, will run all setup ExecNodes. Defaults to None.</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        exclude_nodes (Optional[List[XNId]], optional): The ExecNodes that the user aims to exclude from the DAG.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            The user is responsible for ensuring that the overlapping between the target_nodes and exclude_nodes is logical.</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">target_nodes</span><span class="o">=</span><span class="n">target_nodes</span><span class="p">,</span> <span class="n">exclude_nodes</span><span class="o">=</span><span class="n">exclude_nodes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="tawazi.dag.DAGExecution.get_node_by_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_node_by_id</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span></code>

<a href="#tawazi.dag.DAGExecution.get_node_by_id" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get node with the given id.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id_</code></td>
          <td>
                <code><span title="tawazi.consts.Identifier">Identifier</span></code>
          </td>
          <td><p>id of the ExecNode</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>ExecNode</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="tawazi.node.ExecNode" href="../nodes/#tawazi.node.ExecNode">ExecNode</a></code>
          </td>
          <td><p>Corresponding ExecNode</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>tawazi/dag.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="k">def</span> <span class="nf">get_node_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExecNode</span><span class="p">:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get node with the given id.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        id_ (Identifier): id of the ExecNode</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">        ExecNode: Corresponding ExecNode</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="c1"># TODO: ? catch the keyError and</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>    <span class="c1">#   help the user know the id of the ExecNode by pointing to documentation!?</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executed</span><span class="p">:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">get_node_by_id</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="tawazi.dag.DAGExecution.get_nodes_by_tag" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nodes_by_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span></code>

<a href="#tawazi.dag.DAGExecution.get_nodes_by_tag" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get all the nodes with the given tag.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tag</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>tag of ExecNodes in question</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="tawazi.node.ExecNode" href="../nodes/#tawazi.node.ExecNode">ExecNode</a>]</code>
          </td>
          <td><p>List[ExecNode]: corresponding ExecNodes</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>tawazi/dag.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="k">def</span> <span class="nf">get_nodes_by_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ExecNode</span><span class="p">]:</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all the nodes with the given tag.</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        tag (Any): tag of ExecNodes in question</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">        List[ExecNode]: corresponding ExecNodes</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executed</span><span class="p">:</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">ex_n</span> <span class="k">for</span> <span class="n">ex_n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xn_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">ex_n</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">tag</span><span class="p">]</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">get_nodes_by_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6df46069.min.js"></script>
      
    
  </body>
</html>